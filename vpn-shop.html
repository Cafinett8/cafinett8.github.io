<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙØ±ÙˆØ´ ÙÛŒÙ„ØªØ±Ø´Ú©Ù† - Ú©Ø§ÙÛŒ Ù†Øª</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ø­ÙØ¸ Ú©Ù† Ùˆ Ø§ÛŒÙ†Ø§ Ø±Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† */
        
        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            text-align: center;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: inline-block;
            margin: 10px;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
        }
        
        .file-name {
            margin-top: 10px;
            font-size: 1rem;
            color: #93c5fd;
        }
        
        .preview-image {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            margin-top: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            display: none;
        }
        
        .upload-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ø­ÙØ¸ Ú©Ù† -->
    
    <!-- Ø¯Ø± ÙØ±Ù… Ø§Ø±Ø³Ø§Ù„ Ø±Ø³ÛŒØ¯ØŒ Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø±Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† -->
    <div class="upload-section">
        <div class="upload-icon">ğŸ“·</div>
        <div style="margin-bottom: 15px;">
            <strong>Ø¢Ù¾Ù„ÙˆØ¯ Ø¹Ú©Ø³ Ø±Ø³ÛŒØ¯ Ù¾Ø±Ø¯Ø§Ø®Øª</strong>
            <br>
            <small>Ø¹Ú©Ø³ ÙˆØ§Ø¶Ø­ Ø§Ø² Ø±Ø³ÛŒØ¯ Ø¨Ø§Ù†Ú©ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</small>
        </div>
        
        <input type="file" id="receiptImage" accept="image/*" style="display: none;">
        <button type="button" class="upload-btn" onclick="document.getElementById('receiptImage').click()">
            ğŸ“¸ Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ú©Ø³
        </button>
        
        <div id="fileName" class="file-name"></div>
        <img id="imagePreview" class="preview-image" src="" alt="Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³">
    </div>

    <script>
        let receiptFile = null;
        
        // Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø¹Ú©Ø³
        document.getElementById('receiptImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                receiptFile = file;
                document.getElementById('fileName').textContent = `ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡: ${file.name}`;
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imagePreview').src = e.target.result;
                    document.getElementById('imagePreview').style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });
        
        // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…
        async function sendOrderToTelegram(formData) {
            const botToken = '8549605115:AAGCvusxHBcdRFvqOMYc8liu80kUjmfl0S8';
            const chatId = '7537680867';
            
            // Ø³Ø§Ø®Øª Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ
            const textMessage = `
ğŸ¯ **Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯ ÙÛŒÙ„ØªØ±Ø´Ú©Ù†**
ğŸ“¦ Ø¨Ø³ØªÙ‡: ${formData.package}
ğŸ’° Ù‚ÛŒÙ…Øª: ${formData.price}
ğŸ‘¤ Ù†Ø§Ù…: ${formData.name}
ğŸ“ ØªÙ„ÙÙ†: ${formData.phone}
ğŸ“ Ø¢Ø¯Ø±Ø³ Ø§Ø±Ø³Ø§Ù„: ${formData.address}
ğŸ”¢ Ø´Ù…Ø§Ø±Ù‡ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ: ${formData.receipt}
â° Ø²Ù…Ø§Ù†: ${new Date().toLocaleString('fa-IR')}
            `;
            
            try {
                // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ
                await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: textMessage,
                        parse_mode: 'Markdown'
                    })
                });
                
                // Ø§Ú¯Ø± Ø¹Ú©Ø³ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ØŒ Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³
                if (receiptFile) {
                    const photoFormData = new FormData();
                    photoFormData.append('chat_id', chatId);
                    photoFormData.append('photo', receiptFile);
                    photoFormData.append('caption', `ğŸ“· Ø¹Ú©Ø³ Ø±Ø³ÛŒØ¯ Ù¾Ø±Ø¯Ø§Ø®Øª - ${formData.name}`);
                    
                    await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                        method: 'POST',
                        body: photoFormData
                    });
                }
                
                return true;
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…:', error);
                return false;
            }
        }
        
        // Ø¯Ø± Ù‚Ø³Ù…Øª Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù…ØŒ Ø§ÛŒÙ† Ø±Ùˆ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†
        document.getElementById('paymentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                package: selectedPackage.size + ' - ' + selectedPackage.price + ' ØªÙˆÙ…Ø§Ù†',
                price: selectedPackage.price,
                name: document.getElementById('customerName').value,
                phone: document.getElementById('customerPhone').value,
                address: document.getElementById('customerAddress').value,
                receipt: document.getElementById('receiptNumber').value
            };
            
            // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…
            const telegramSent = await sendOrderToTelegram(formData);
            
            if (telegramSent) {
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('submitBtn').textContent = 'âœ… Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯';
            } else {
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª. Ù„Ø·ÙØ§Ù‹ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ù¾ÛŒØ§Ù… Ø¯Ù‡ÛŒØ¯.');
            }
        });
    </script>
</body>
</html>
